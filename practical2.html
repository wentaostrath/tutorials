
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Practical 2: Thermal plasma &#8212; Smilei 73aaa37 documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '73aaa37',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Practical 3: Weibel and two-stream instabilities" href="practical3.html" />
    <link rel="prev" title="Practical 1: Laser Propagation in vacuum" href="practical1.html" />
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
  
   

  </head>
  <body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
          <li class="outer">
              <a href="setup.html">Setup</a>
          </li>
        </ul>
        <hr />
        <ul>
          <li class="outer">
              <a href="practical1.html">Tutorial 1</a>
          </li>
          <li class="outer">
              <a href="#">Tutorial 2</a>
          </li>
          <li class="outer">
              <a href="practical3.html">Tutorial 3</a>
          </li>
          <li class="outer">
              <a href="practical4.html">Tutorial 4</a>
          </li>
        </ul>
        <hr />
        <ul>
          <li class="outer">
              <a href="advanced_practical1.html">Advanced tutorial 1</a>
          </li>
          <li class="outer">
              <a href="advanced_practical2.html">Advanced tutorial 2</a>
          </li>
          <li class="outer">
              <a href="advanced_practical3.html">Advanced tutorial 3</a>
          </li>
          <li class="outer">
              <a href="advanced_practical4.html">Advanced tutorial 4</a>
          </li>
        </ul>
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Practical 2: Thermal plasma</a></div>
                <ul>
<li><a class="reference internal" href="#">Practical 2: Thermal plasma</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#check-input-file-and-run-the-simulation">Check input file and run the simulation</a></li>
<li><a class="reference internal" href="#preparing-the-post-processing-tool">Preparing the post-processing tool</a></li>
<li><a class="reference internal" href="#the-field-diagnostics-using-happi-multiplot">The <code class="docutils literal"><span class="pre">Field</span></code> diagnostics using <code class="docutils literal"><span class="pre">happi.multiPlot</span></code></a></li>
<li><a class="reference internal" href="#the-particlebinning-diagnostics">The <code class="docutils literal"><span class="pre">ParticleBinning</span></code> diagnostics</a></li>
<li><a class="reference internal" href="#effect-of-spatial-resolution">Effect of spatial resolution</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo_tutorials.svg" alt="Logo" />
            </a>
        </div>
        
    
            
        
        <div class="menu" id="menu_Setup">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Setup')" onclick="toggleMenu('menu_Setup')" onmousedown="event.preventDefault()">
                <span>Info</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="setup.html">Setup</a>
                        </li>
            
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="menu" id="menu_Tutorial 1">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Tutorial 1')" onclick="toggleMenu('menu_Tutorial 1')" onmousedown="event.preventDefault()">
                <span>Basic</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="practical1.html">Tutorial 1</a>
                        </li>
                        <li class="outer">
                            <a href="#">Tutorial 2</a>
                        </li>
                        <li class="outer">
                            <a href="practical3.html">Tutorial 3</a>
                        </li>
                        <li class="outer">
                            <a href="practical4.html">Tutorial 4</a>
                        </li>
            
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="menu" id="menu_Advanced tutorial 1">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Advanced tutorial 1')" onclick="toggleMenu('menu_Advanced tutorial 1')" onmousedown="event.preventDefault()">
                <span>Advanced</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="advanced_practical1.html">Advanced tutorial 1</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical2.html">Advanced tutorial 2</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical3.html">Advanced tutorial 3</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical4.html">Advanced tutorial 4</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu()">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="practical3.html" title="Practical 3: Weibel and two-stream instabilities"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="practical1.html" title="Practical 1: Laser Propagation in vacuum"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Smilei 73aaa37 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
  <div class="section" id="practical-2-thermal-plasma">
<h1>Practical 2: Thermal plasma<a class="headerlink" href="#practical-2-thermal-plasma" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to get familiar with:</p>
<ul class="simple">
<li>the <code class="docutils literal"><span class="pre">Species</span></code> block that allows you to define a particle species,</li>
<li>the <code class="docutils literal"><span class="pre">ParticleBinning</span></code> diagnostics to obtain particle energy spectra,</li>
<li>the <code class="docutils literal"><span class="pre">happi.multiPlot</span></code> tool,</li>
<li>the problem of <cite>numerical heating</cite> and the necessity to correctly <cite>resolve the electron dynamics</cite> in explicit PIC codes.</li>
</ul>
<hr class="docutils" />
<div class="section" id="physical-configuration">
<h2>Physical configuration<a class="headerlink" href="#physical-configuration" title="Permalink to this headline">¶</a></h2>
<p>Download the input file <a class="reference external" href="thermal_plasma_1d.py">thermal_plasma_1d.py</a>.</p>
<p>An <cite>infinite</cite> electron-ion plasma is let free to evolve in a 1D cartesian
geometry with periodic boundary conditions.</p>
</div>
<hr class="docutils" />
<div class="section" id="check-input-file-and-run-the-simulation">
<h2>Check input file and run the simulation<a class="headerlink" href="#check-input-file-and-run-the-simulation" title="Permalink to this headline">¶</a></h2>
<p>The first step is to check that your <cite>input file</cite> is correct.
To do so, you will run (locally) <strong class="program">Smilei</strong> in test mode:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>./smilei_test thermal_plasma_1d.py
</pre></div>
</div>
<p>If your simulation <cite>input file</cite> is correct, you can now run the simulation.
Before going to the analysis of your simulation, check your <em>log</em> and/or
<em>error</em> output.</p>
<p>Check what output files have been generated: what are they?</p>
</div>
<hr class="docutils" />
<div class="section" id="preparing-the-post-processing-tool">
<h2>Preparing the post-processing tool<a class="headerlink" href="#preparing-the-post-processing-tool" title="Permalink to this headline">¶</a></h2>
<p>Let’s now turn to analysing the output of your run with <strong class="program">happi</strong>.
To do so, open an <code class="docutils literal"><span class="pre">ipython</span></code> session:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ipython
</pre></div>
</div>
<p>In <em>ipython</em>, import the <strong class="program">happi</strong> package:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">happi</span>
</pre></div>
</div>
<p>then open your simulation:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">happi</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s1">&#39;/path/to/the/simulation&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Use the correct simulation path.</p>
</div>
<p>You are now ready to take a look at your simulation’s results.</p>
</div>
<hr class="docutils" />
<div class="section" id="the-field-diagnostics-using-happi-multiplot">
<h2>The <code class="docutils literal"><span class="pre">Field</span></code> diagnostics using <code class="docutils literal"><span class="pre">happi.multiPlot</span></code><a class="headerlink" href="#the-field-diagnostics-using-happi-multiplot" title="Permalink to this headline">¶</a></h2>
<p>To have a quick access at your data and <cite>check</cite> what is going on, you will plot
the electron and ion densities together with the electrostatic field <span class="math">\(E_x\)</span>.</p>
<p>First, <cite>prepare</cite> the data:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># minus the electron density</span>
<span class="n">ne</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;-Rho_eon&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.25</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;e- density&quot;</span><span class="p">)</span>

<span class="c1"># ion density</span>
<span class="n">ni</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Rho_ion&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ion density&quot;</span><span class="p">)</span>

<span class="c1"># Ex field</span>
<span class="n">ex</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">Field</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;Ex&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ex field&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You may plot all these quantities independently using <code class="docutils literal"><span class="pre">ex.plot()</span></code> or <code class="docutils literal"><span class="pre">ex.animate()</span></code>,
but you can also use the <code class="docutils literal"><span class="pre">multiPlot</span></code> function of <strong class="program">happi</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">happi</span><span class="o">.</span><span class="n">multiPlot</span><span class="p">(</span><span class="n">ne</span><span class="p">,</span><span class="n">ni</span><span class="p">,</span><span class="n">ex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-particlebinning-diagnostics">
<h2>The <code class="docutils literal"><span class="pre">ParticleBinning</span></code> diagnostics<a class="headerlink" href="#the-particlebinning-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>Now, have a look at the <code class="docutils literal"><span class="pre">ParticleBinning</span></code> diagnostics, and in particular
at the electron energy distribution at initial and latest timesteps:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Nt</span>        <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">namelist</span><span class="o">.</span><span class="n">tsim</span> <span class="o">/</span> <span class="n">S</span><span class="o">.</span><span class="n">namelist</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
<span class="n">f_initial</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">ParticleBinning</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_log</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="mi">0</span> <span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;initial&quot;</span><span class="p">)</span>
<span class="n">f_final</span>   <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">ParticleBinning</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">data_log</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">timesteps</span><span class="o">=</span><span class="n">Nt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;final&quot;</span><span class="p">)</span>
<span class="n">happi</span><span class="o">.</span><span class="n">multiPlot</span><span class="p">(</span><span class="n">f_initial</span><span class="p">,</span> <span class="n">f_final</span><span class="p">)</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="effect-of-spatial-resolution">
<h2>Effect of spatial resolution<a class="headerlink" href="#effect-of-spatial-resolution" title="Permalink to this headline">¶</a></h2>
<p>Have a look at the total energy and energy balance in your simulation
(remember the <code class="docutils literal"><span class="pre">Utot</span></code> and <code class="docutils literal"><span class="pre">Ubal</span></code> scalars).
Note the level of energy imbalance at the end of this simulation for which
the spatial resolution is equal to the Debye Length (<span class="math">\(\Delta x = \lambda_{\rm De}\)</span>).</p>
<p>Increase your spatial resolution to <span class="math">\(\Delta x = 16 \times \lambda_{\rm De}\)</span>.
Run the simulation again, and check the energy imbalance at the end of the simulation.
What do you observe?
Can you check the electron spectrum at the beginning and end of the simulation?
What is going on?</p>
<p>Finally, increase your spatial resolution to <span class="math">\(\Delta x = 2\,c/\omega_{pe}\)</span>.
Check the evolution of the total energy.
What do you observe?</p>
</div>
</div>


        </div></div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="practical3.html" title="Practical 3: Weibel and two-stream instabilities"
             >next</a> |</li>
        <li class="right" >
          <a href="practical1.html" title="Practical 1: Laser Propagation in vacuum"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Smilei 73aaa37 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Jan 11, 2018
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu() {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>