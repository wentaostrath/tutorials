
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Advanced Practical 1: Synchrotron-like Radiation reaction processes &#8212; Smilei 73aaa37 documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '73aaa37',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process" href="advanced_practical2.html" />
    <link rel="prev" title="Practical 4: Field ionization" href="practical4.html" />
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
  
   

  </head>
  <body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
          <li class="outer">
              <a href="setup.html">Setup</a>
          </li>
        </ul>
        <hr />
        <ul>
          <li class="outer">
              <a href="practical1.html">Tutorial 1</a>
          </li>
          <li class="outer">
              <a href="practical2.html">Tutorial 2</a>
          </li>
          <li class="outer">
              <a href="practical3.html">Tutorial 3</a>
          </li>
          <li class="outer">
              <a href="practical4.html">Tutorial 4</a>
          </li>
        </ul>
        <hr />
        <ul>
          <li class="outer">
              <a href="#">Advanced tutorial 1</a>
          </li>
          <li class="outer">
              <a href="advanced_practical2.html">Advanced tutorial 2</a>
          </li>
          <li class="outer">
              <a href="advanced_practical3.html">Advanced tutorial 3</a>
          </li>
          <li class="outer">
              <a href="advanced_practical4.html">Advanced tutorial 4</a>
          </li>
        </ul>
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Advanced Practical 1: Synchrotron-like Radiation reaction processes</a></div>
                <ul>
<li><a class="reference internal" href="#">Advanced Practical 1: Synchrotron-like Radiation reaction processes</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#content-of-the-tutorial">Content of the tutorial</a></li>
<li><a class="reference internal" href="#first-simulation-the-classical-model-of-landau-lifshitz">First simulation: the classical model of Landau-Lifshitz</a></li>
<li><a class="reference internal" href="#second-simulation-the-corrected-landau-lifshitz-model">Second simulation: the corrected Landau-Lifshitz model</a></li>
<li><a class="reference internal" href="#third-simulation-the-stochastic-model-of-niel-et-al">Third simulation: the stochastic model of Niel <em>et al.</em></a></li>
<li><a class="reference internal" href="#fourth-simulation-the-monte-carlo-model">Fourth simulation: the Monte-Carlo model</a></li>
<li><a class="reference internal" href="#comparison-of-the-radiation-reaction-models">Comparison of the radiation reaction models</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo_tutorials.svg" alt="Logo" />
            </a>
        </div>
        
    
            
        
        <div class="menu" id="menu_Setup">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Setup')" onclick="toggleMenu('menu_Setup')" onmousedown="event.preventDefault()">
                <span>Info</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="setup.html">Setup</a>
                        </li>
            
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="menu" id="menu_Tutorial 1">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Tutorial 1')" onclick="toggleMenu('menu_Tutorial 1')" onmousedown="event.preventDefault()">
                <span>Basic</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="practical1.html">Tutorial 1</a>
                        </li>
                        <li class="outer">
                            <a href="practical2.html">Tutorial 2</a>
                        </li>
                        <li class="outer">
                            <a href="practical3.html">Tutorial 3</a>
                        </li>
                        <li class="outer">
                            <a href="practical4.html">Tutorial 4</a>
                        </li>
            
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="menu" id="menu_Advanced tutorial 1">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Advanced tutorial 1')" onclick="toggleMenu('menu_Advanced tutorial 1')" onmousedown="event.preventDefault()">
                <span>Advanced</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="#">Advanced tutorial 1</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical2.html">Advanced tutorial 2</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical3.html">Advanced tutorial 3</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical4.html">Advanced tutorial 4</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu()">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="advanced_practical2.html" title="Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="practical4.html" title="Practical 4: Field ionization"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Smilei 73aaa37 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
  <div class="section" id="advanced-practical-1-synchrotron-like-radiation-reaction-processes">
<h1>Advanced Practical 1: Synchrotron-like Radiation reaction processes<a class="headerlink" href="#advanced-practical-1-synchrotron-like-radiation-reaction-processes" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to present how to use the radiative and QED processes in
<strong class="program">Smilei</strong>.
The following points will be addressed:</p>
<ul class="simple">
<li>How to prepare input files for these physical modules</li>
<li>How to setup radiation reaction models</li>
<li>How to use <strong class="program">Smilei</strong> diagnostics</li>
<li>How to read and understand generated outputs</li>
</ul>
<hr class="docutils" />
<div class="section" id="physical-configuration">
<h2>Physical configuration<a class="headerlink" href="#physical-configuration" title="Permalink to this headline">¶</a></h2>
<p>A multi-GeV electron beam is made to collide with a counter-propagating plane wave.
This configuration is one of the most efficient to trigger radiative and QED effects.
It maximizes the value of the quantum parameter for a given electron energy and a given
field strength.</p>
<p>The simulation is 2D Cartesian with a simulation size of <span class="math">\(30 \lambda \times 4 \lambda\)</span>
where <span class="math">\(\lambda\)</span> is the laser wavelength. The laser is injected from the left side
of the simulation domain while the electron beam is initialized at the extreme right.</p>
<p>In this initial configuration, the laser has a wavelength of <span class="math">\(\lambda = 1\ \mu \mathrm{m}\)</span>,
an amplitude of <span class="math">\(10^{22}\ \mathrm{W/cm}^2\)</span> (<span class="math">\(a_0 \simeq 100\)</span>) and is linearly polarized
in the <span class="math">\(y\)</span> direction. The temporal profile is Gaussian (order 4).
The full width at half maximum (FWHM) is of 10 laser periods (approximately 33 fs).</p>
<p>The electron beam has an initial energy of 1 GeV and propagates to the left.
The beam density is of <span class="math">\(n_b = 10^{-5} n_c\)</span>. The electron beam is frozen the
time for the laser to be fully injected and so that the collision occurred at the
middle of the domain. This enables to have a shorter simulation box and therefore
save computational time. The beam is initialized with 32 particles per cell for a
total of 12480 macro-particles.</p>
</div>
<hr class="docutils" />
<div class="section" id="content-of-the-tutorial">
<h2>Content of the tutorial<a class="headerlink" href="#content-of-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Download <a class="reference external" href="AdvancedPractical1.tar.gz">AdvancedPractical1.tar.gz</a> and extract it.
It contains 2 directories:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Analysis</span></code></li>
<li><code class="docutils literal"><span class="pre">Execution</span></code></li>
</ul>
<p>The directory <code class="docutils literal"><span class="pre">Analysis</span></code> contains <cite>Python</cite> scripts that will be used to analysis
and visualize the simulation outputs.
Each script has been designed to focus on a specific quantity:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">show_energy_balance.py</span></code>: display the time evolution of the electron normalized kinetic energy and the radiated energy.</li>
<li><code class="docutils literal"><span class="pre">show_2d_density.py</span></code>: display the 2d colormap of the electron normalized density.</li>
<li><code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>: display the 2d colormap of the electron average normalized energy.</li>
<li><code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>: display the 2d colormap of the electron local quantum parameter.</li>
<li><code class="docutils literal"><span class="pre">show_2d_fields.py</span></code>: display 2D colormaps  of the electric field <span class="math">\(E_y\)</span> and the magnetic field <span class="math">\(B_z\)</span>.</li>
<li><code class="docutils literal"><span class="pre">compare_energy_balance_Landau_Lifshitz.py</span></code></li>
<li><code class="docutils literal"><span class="pre">compare_energy_balance_radiation_models.py</span></code></li>
<li><code class="docutils literal"><span class="pre">compare_2d_density_radiation_models.py</span></code></li>
<li><code class="docutils literal"><span class="pre">compare_2d_average_energy_radiation_models.py</span></code></li>
<li><code class="docutils literal"><span class="pre">compare_2d_average_chi_radiation_models.py</span></code></li>
</ul>
<p>The <code class="docutils literal"><span class="pre">Execution</span></code> directory contains the input file:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tst2d_electron_laser_collision.py</span></code></li>
</ul>
<p>We will perform simulations step by step for each radiation model.
We will use the Python script available in <code class="docutils literal"><span class="pre">Analysis</span></code> to analyze the
generated outputs.</p>
</div>
<hr class="docutils" />
<div class="section" id="first-simulation-the-classical-model-of-landau-lifshitz">
<h2>First simulation: the classical model of Landau-Lifshitz<a class="headerlink" href="#first-simulation-the-classical-model-of-landau-lifshitz" title="Permalink to this headline">¶</a></h2>
<p>Let us first use the continuous classical model of Landau-Lifshitz.
This radiation reaction model is valid in the so-called classical regime when
the particle quantum parameter <code class="docutils literal"><span class="pre">chi</span></code> is below <span class="math">\(10^{-2}\)</span>.
The version implemented in <strong class="program">Smilei</strong> is an approximation for high
gamma factor that enables to simplify and remove some terms.</p>
<ul>
<li><p class="first">copy the directory <code class="docutils literal"><span class="pre">Execution</span></code> into a new directory called <code class="docutils literal"><span class="pre">Radiation_Landau_Lifshitz</span></code>
in which we will work:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp -r Execution Radiation_Landau_Lifshitz
</pre></div>
</div>
</li>
<li><p class="first">Go into this directory and open the input file <code class="docutils literal"><span class="pre">tst2d_electron_laser_collision.py</span></code>.</p>
</li>
</ul>
<p>We will now setup the radiation reaction parameters.</p>
<ul>
<li><p class="first">Go to the block called <code class="docutils literal"><span class="pre">RadiationReaction</span></code>. This block is commented.
Uncomment it and the parameter called <code class="docutils literal"><span class="pre">chipa_radiation_threshold</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">RadiationReaction</span><span class="p">(</span>
     <span class="n">chipa_radiation_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="c1">#     chipa_disc_min_threshold = 1e-2,</span>
<span class="c1">#     table_path = &quot;/gpfshome/mds/staff/mlobet/smilei/databases/&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This block is used to setup the general parameters. Only <code class="docutils literal"><span class="pre">chipa_radiation_threshold</span></code>
is useful for the moment. This parameter corresponds to the minimal value of the
quantum parameter at which the radiation reaction process is applied.
Below this value, the particle does not undergo radiation loss.
To specify this parameter is not compulsory since it is defined by default at <cite>1e-3</cite>.</p>
</li>
<li><p class="first">Now go to the block of the first species called <code class="docutils literal"><span class="pre">electron</span></code>.
Only this species will be present in the simulation for the moment.</p>
</li>
<li><p class="first">Uncomment the parameter <code class="docutils literal"><span class="pre">radiation_model</span></code>.
This parameter corresponds to the radiation model you want to use.
By default, this parameter is set to <code class="docutils literal"><span class="pre">None</span></code> meaning no radiation loss.
To use the Landau-Lifshitz radiation model, use:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;Landau-Lifshitz&quot;</span>
</pre></div>
</div>
<p>The other commented parameters are not useful for the moment.</p>
</li>
<li><p class="first">You may now run the simulation. We recommend you to run it in parallel
with at least 4 cores. By default, 16 patches have been specified. If you want
to run this input file with more than 16 MPI tasks and OpenMP threads,
you have to increase the number of patches accordingly.</p>
</li>
</ul>
<p>At the end of the run, you can see that several files have been generated including
the particle binning (<code class="docutils literal"><span class="pre">ParticleBinning*.h5</span></code>), the fields (<code class="docutils literal"><span class="pre">Fields*.h5</span></code>) and
the scalar (<code class="docutils literal"><span class="pre">scalars.txt</span></code>) diagnostics.</p>
<ul>
<li><p class="first">We will use the python script <code class="docutils literal"><span class="pre">show_energ_balance.py</span></code> to plot the time evolution
of the particle normalized kinetic energy. Copy this file from the Analysis directory
to the current one:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_energy_balance.py .
</pre></div>
</div>
</li>
<li><p class="first">Open this file and take the time to read and understand it.
You can see that the script is decomposed into several sections.
The section <cite>Smilei general information</cite> will open and scan the result directory
thanks to <code class="docutils literal"><span class="pre">S</span> <span class="pre">=</span> <span class="pre">happi.Open(path,</span> <span class="pre">verbose=False)</span></code>.
The results are read in the section <cite>Scalar diagnostics</cite>.
The command <code class="docutils literal"><span class="pre">S.Scalar(&quot;Ukin_electron&quot;)</span></code> enables to select a scalar quantity object
(for the electron kinetic energy here). We use the method <code class="docutils literal"><span class="pre">get</span></code> to get the raw data
contains in the scalar object. We then manually plot the data via <cite>Matplotlib</cite>.
This method is another approach of using the <strong class="program">Smilei</strong> Python
library and differs from what you may have seen before.</p>
</li>
<li><p class="first">Run the script in an <em>ipython</em> prompt:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">run</span> <span class="n">show_energy_balance</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Or you can also run it directly in your terminal by adding the interactive option:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>python -i show_energy_balance.py
</pre></div>
</div>
<p>You obtain a plot of the time evolution of the electron normalized energy and
the radiated energy (purple). There is no positron or photons here.</p>
</li>
<li><p class="first">What do you observe? You can see that during the laser interaction
(starting from <span class="math">\(t = 240 \omega_r^{-1}\)</span>), the electron kinetic energy
is rapidly converted into radiations via the radiative model.</p>
</li>
<li><p class="first">Estimate the maximal quantum parameter reached during the simulation.
For this aim, you can use the python script <code class="docutils literal"><span class="pre">Analysis/show_2d_average_chi.py</span></code>.
Copy this script in the current working directory and run it in <em>ipython</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">run</span> <span class="n">show_2d_average_chi</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>You obtain a 2D colormap of the beam.
The color corresponds to the local value of the quantum parameter.
The terminal gives the maximal value. What do you think about this value regarding the
model validity?</p>
</li>
<li><p class="first">Open the python script <code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>.
Take the time to read it to understand. In the <cite>parameters</cite> section,
change the <code class="docutils literal"><span class="pre">timestep</span></code> value and run again the script to see how the quantum
parameter evolves. Particle binning diagnostics are output every 500 iterations.
By this way you can see when the beam starts to radiate while entering the laser field.
The maximal available iteration is 8000.</p>
</li>
<li><p class="first">Similarly, use the Python script <code class="docutils literal"><span class="pre">show_2d_density.py</span></code> (located in <code class="docutils literal"><span class="pre">Analysis</span></code>)
to plot a 2D colormap of the electron density and <code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>
to plot the 2D colormap of the local average kinetic energy.
Copy these scripts in the current working directory and use <cite>ipython</cite> to run them
as in the previous item. Open them and change the <code class="docutils literal"><span class="pre">timestep</span></code> parameter.</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="second-simulation-the-corrected-landau-lifshitz-model">
<h2>Second simulation: the corrected Landau-Lifshitz model<a class="headerlink" href="#second-simulation-the-corrected-landau-lifshitz-model" title="Permalink to this headline">¶</a></h2>
<p>We will now perform the same simulation with the corrected Landau-Lifshitz model.
This model includes a quantum correction that extends the domain of validity
to higher quantum parameters, around <span class="math">\(\chi \sim 10^{-1}\)</span>.</p>
<ul class="simple">
<li>copy the previous working directory <code class="docutils literal"><span class="pre">Radiation_Landau_Lifshitz</span></code> into a new directory
called <code class="docutils literal"><span class="pre">Radiation_corrected_Landau_Lifshitz</span></code> in which we will now work:</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp -r Radiation_Landau_Lifshitz Radiation_corrected_Landau_Lifshitz
<span class="nb">cd</span> Radiation_corrected_Landau_Lifshitz
</pre></div>
</div>
<ul class="simple">
<li>Open the input file script <code class="docutils literal"><span class="pre">tst2d_electron_laser_collision</span></code>.
Go to the <code class="docutils literal"><span class="pre">electron</span></code> species block.
To use the <code class="docutils literal"><span class="pre">corrected</span> <span class="pre">Landau-Lifshitz</span></code> radiation model, simply use:</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;corrected-Landau-Lifshitz&quot;</span>
</pre></div>
</div>
<p>This radiative model requires the same global setup as the <code class="docutils literal"><span class="pre">Landau-Lifshitz</span></code> one.</p>
<ul>
<li><p class="first">You can run the simulation.</p>
</li>
<li><p class="first">Compare the evolution of the energy balance to the <code class="docutils literal"><span class="pre">Landau-Lifshitz</span></code> model.
For this aim you can copy the script <code class="docutils literal"><span class="pre">show_energy_balance.py</span></code> in the current
working directory and run it using ipython:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">run</span> <span class="n">show_energy_balance</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Compare the generated plot with the one from the <code class="docutils literal"><span class="pre">Landau-Lifshitz</span></code> simulation.</p>
</li>
<li><p class="first"><strong>Optional exercice:</strong> using <code class="docutils literal"><span class="pre">show_energy_balance.py</span></code>, create you own python script
to plot on the same figure the time evolution of the energy balance for the
classical Landau-Lifshitz and the corrected Landau-Lifshitz model.</p>
<p><strong>Solution:</strong> See the Python script <code class="docutils literal"><span class="pre">Analysis/compare_energy_balance_Landau-Lifshitz.py</span></code>.</p>
<img alt="_images/compare_energy_balance_Landau_Lifshitz.png" src="_images/compare_energy_balance_Landau_Lifshitz.png" />
</li>
<li><p class="first">Question: What do you observe? You can see that the energy drops less rapidly
with the corrected Landau-Lifshitz model.
This means that we are out of the validity scope of the classical Landau-Lifshitz
model with the current laser and electron parameters.</p>
</li>
<li><p class="first"><strong>Optional exercice:</strong> as for the previous model, use the Python scripts to
plot 2D colormap of the density (<code class="docutils literal"><span class="pre">show_2d_density.py</span></code>), the normalized kinetic
energy (<code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>) and the quantum parameter (<code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>).</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="third-simulation-the-stochastic-model-of-niel-et-al">
<h2>Third simulation: the stochastic model of Niel <em>et al.</em><a class="headerlink" href="#third-simulation-the-stochastic-model-of-niel-et-al" title="Permalink to this headline">¶</a></h2>
<p>The model of Niel <em>et al.</em> is the first stochastic model available in <strong class="program">Smilei</strong>.
It is an extension of the corrected Landau-Lifshitz model with
an additional stochastic operator derived from a Fokker-Planck approach.</p>
<ul>
<li><p class="first">Copy the previous working directory <code class="docutils literal"><span class="pre">Radiation_Landau_Lifshitz</span></code> into a new directory
called <code class="docutils literal"><span class="pre">Radiation_Niel</span></code> in which we will now work:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp -r Radiation_Landau_Lifshitz Radiation_Niel
<span class="nb">cd</span> Radiation_Niel
</pre></div>
</div>
</li>
<li><p class="first">Open the input file <code class="docutils literal"><span class="pre">tst2d_electron_laser_collision.py</span></code> and
go to the <code class="docutils literal"><span class="pre">electron</span></code> species block. Modify the <code class="docutils literal"><span class="pre">radiation_model</span></code> by</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;Niel&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">The Niel radiation model uses tabulated values. External Tables are available
in the <code class="docutils literal"><span class="pre">SMILEI/databases</span></code> directory in the sources. In order to specify
in the input file  where these tables are located, we have to modify the
block <code class="docutils literal"><span class="pre">RadiationReaction</span></code> previously uncommented.
Uncomment the table_path parameter as follow:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">RadiationReaction</span><span class="p">(</span>
     <span class="n">chipa_radiation_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="c1">#     chipa_disc_min_threshold = 1e-2,</span>
     <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;path_to_smilei&gt;/databases/&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>And update the path to <strong class="program">Smilei</strong> according to your installation configuration.</p>
</li>
<li><p class="first">You can run the simulation</p>
<p>By looking at the standart output (the <em>log</em>) that contains the simulation output,
you can check that the external tables have been well read.</p>
</li>
<li><p class="first">Use the script <code class="docutils literal"><span class="pre">show_energ_balance.py</span></code> to plot the evolution of the energy
balance for this simulation. Compare the results to the corrected Landau-Lifshitz model.</p>
</li>
<li><p class="first"><strong>Optional exercice:</strong> as for the previous model, use the Python scripts to
plot 2D colormap of the density (<code class="docutils literal"><span class="pre">show_2d_density.py</span></code>), the normalized kinetic
energy (<code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>) and the quantum parameter (<code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>).</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="fourth-simulation-the-monte-carlo-model">
<h2>Fourth simulation: the Monte-Carlo model<a class="headerlink" href="#fourth-simulation-the-monte-carlo-model" title="Permalink to this headline">¶</a></h2>
<p>The Monte-Carlo model is the second stochastic one of the list of implemented models.
You can have more information about the model and its implementation on the page
<code class="docutils literal"><span class="pre">Synchrotron-like</span> <span class="pre">radiation</span> <span class="pre">reaction</span></code> fn the <strong class="program">Smilei</strong> website.</p>
<ul>
<li><p class="first">copy the previous working directory <code class="docutils literal"><span class="pre">Radiation_Niel</span></code> into a new directory
called <code class="docutils literal"><span class="pre">Radiation_Monte-Carlo</span></code> in which we will now work:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp -r Radiation_Niel Radiation_Monte_Carlo
<span class="nb">cd</span> Radiation_Monte_Carlo
</pre></div>
</div>
</li>
<li><p class="first">Open the input file <code class="docutils literal"><span class="pre">tst2d_electron_laser_collision.py</span></code> and
go to the <code class="docutils literal"><span class="pre">electron</span></code> species block. Modify the <code class="docutils literal"><span class="pre">radiation_model</span></code> by</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;Monte-Carlo&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Like the Niel radiation model, the Monte-Carlo algorithm uses tabulated values.
The same path needs to be specified in the block <code class="docutils literal"><span class="pre">RadiationReaction</span></code>.
In addition, set the parameter <code class="docutils literal"><span class="pre">chipa_disc_min_threshold</span></code> to <code class="docutils literal"><span class="pre">1e-2</span></code>
(uncomment the corresponding line).
The Monte-Carlo model is built to work with the continuous corrected
Landau-Lifshitz approach when the particle quantum parameter is too low.
This parameter corresponds to this threshold.
Above this value, a particle undergoes radiation reaction via the Monte-Carlo engine.
Below the continuous approach is used.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">RadiationReaction</span><span class="p">(</span>
     <span class="n">chipa_radiation_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span>
     <span class="n">chipa_disc_min_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
     <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;path_to_smilei&gt;/databases/&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In fact, the default value of <code class="docutils literal"><span class="pre">chipa_disc_min_threshold</span></code> is <code class="docutils literal"><span class="pre">1e-2</span></code>.
Therefore, it has to be specified only to change the default value.
The Monte-Carlo radiation reaction is now fully set.</p>
</li>
<li><p class="first">You can now run the simulation</p>
</li>
<li><p class="first">Use the script <code class="docutils literal"><span class="pre">show_energ_balance.py</span></code> to plot the evolution of the energy
balance for this simulation.</p>
</li>
<li><p class="first"><strong>Optional exercice:</strong> as for the previous model, use the Python scripts to
plot 2D colormap of the density (<code class="docutils literal"><span class="pre">show_2d_density.py</span></code>), the normalized kinetic
energy (<code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>) and the quantum parameter (<code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>).</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="comparison-of-the-radiation-reaction-models">
<h2>Comparison of the radiation reaction models<a class="headerlink" href="#comparison-of-the-radiation-reaction-models" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><strong>Optional exercice:</strong> Using <code class="docutils literal"><span class="pre">show_energy_balance.py</span></code>, create you own python script
to plot on the same figure the time evolution of the energy balance
for the corrected Landau-Lifshitz, the Niel and the Monte-Carlo radiative models.
The solution is given in the next point.</p>
</li>
<li><p class="first"><strong>Solution:</strong> The solution is the Python script
<code class="docutils literal"><span class="pre">Analysis/compare_energy_balance_radiation_models.py</span></code>.
Go to the directory <code class="docutils literal"><span class="pre">Analysis</span></code> to run it.
You should obtain the following figure:</p>
<img alt="_images/compare_energy_balance_radiation_models.png" src="_images/compare_energy_balance_radiation_models.png" />
</li>
<li><p class="first"><strong>Optional exercice:</strong> Using the script <code class="docutils literal"><span class="pre">show_2d_density.py</span></code>, create a
new script to compare on the same figure the electron density of the corrected Landau-Lifshitz,
the Niel and the Monte-Carlo radiative simulation cases.
Observe the shape of the beam after the laser interaction in each case.
Do the same thing for the average local kinetic energy and the
average local quantum parameter using <code class="docutils literal"><span class="pre">show_2d_kinetic_energy.py</span></code> and <code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>.
See the next point for the solution.</p>
</li>
<li><p class="first"><strong>Solutions:</strong> Solutions are the Python script <code class="docutils literal"><span class="pre">Analysis/compare_2d_density_radiation_models.py</span></code>,
<code class="docutils literal"><span class="pre">Analysis/compare_2d_kinetic_energy_radiation_models.py</span></code>,
<code class="docutils literal"><span class="pre">Analysis/compare_2d_average_chi_radiation_models.py</span></code>.
Go to the directory <code class="docutils literal"><span class="pre">Analysis</span></code> to run the solutions.
The beam density at iteration 6500 at the end of the interaction should look
like the following figure:</p>
<img alt="_images/compare_density_radiative_models.png" src="_images/compare_density_radiative_models.png" />
<p>With the script to compare the quantum parameter space-distribution,
you can also have the maximum value of the quantum parameter.</p>
</li>
<li><p class="first"><strong>Optional exercice:</strong> Activate the track particle option to follow trajectories
of some particles in the corrected Landau-Lifshitz,
the Niel and the Monte-Carlo simulation cases and run them again.
Create a python script to read and plot the particle trajectories.
Describe the difference due to the stochasticity.</p>
</li>
<li><p class="first"><strong>Optional exercice</strong>: Play with the laser and electron beam parameters
(laser amplitude, duration, profile and electron energy) to see how
the different models behave. Use the previous scripts to compute the maximum
value of the quantum parameter in each case and see the electron beam properties after
the laser interaction.</p>
</li>
</ul>
</div>
</div>


        </div></div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="advanced_practical2.html" title="Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process"
             >next</a> |</li>
        <li class="right" >
          <a href="practical4.html" title="Practical 4: Field ionization"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Smilei 73aaa37 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Jan 11, 2018
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu() {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>