
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process &#8212; Smilei 73aaa37 documentation</title>
    <link rel="stylesheet" href="_static/smilei_theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '73aaa37',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/smileiIcon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced Practical 3: Electron Laser Wakefield Acceleration (in 2D)" href="advanced_practical3.html" />
    <link rel="prev" title="Advanced Practical 1: Synchrotron-like Radiation reaction processes" href="advanced_practical1.html" />
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
      scale: 95,
      availableFonts: ["TeX"]
    }
  });
  </script>
  
   

  </head>
  <body>

<div id="smallScreenMenu" class="off">

    
    <div class="toctree-smilei">
        <ul>
          <li class="outer">
              <a href="setup.html">Setup</a>
          </li>
        </ul>
        <hr />
        <ul>
          <li class="outer">
              <a href="practical1.html">Tutorial 1</a>
          </li>
          <li class="outer">
              <a href="practical2.html">Tutorial 2</a>
          </li>
          <li class="outer">
              <a href="practical3.html">Tutorial 3</a>
          </li>
          <li class="outer">
              <a href="practical4.html">Tutorial 4</a>
          </li>
        </ul>
        <hr />
        <ul>
          <li class="outer">
              <a href="advanced_practical1.html">Advanced tutorial 1</a>
          </li>
          <li class="outer">
              <a href="#">Advanced tutorial 2</a>
          </li>
          <li class="outer">
              <a href="advanced_practical3.html">Advanced tutorial 3</a>
          </li>
          <li class="outer">
              <a href="advanced_practical4.html">Advanced tutorial 4</a>
          </li>
        </ul>
    </div>

</div>
<div id="hcontainer">
    <div id="nav_positioner">
        <div id="nav">
            <div id="nav_button" onclick="toggleNav()">
                Sections
            </div>
            <div id="nav_list" class="toctree-smilei">
                <div id="nav_title"><a href="#">Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process</a></div>
                <ul>
<li><a class="reference internal" href="#">Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process</a><ul>
<li><a class="reference internal" href="#physical-configuration">Physical configuration</a></li>
<li><a class="reference internal" href="#content-of-the-tutorial">Content of the tutorial</a></li>
<li><a class="reference internal" href="#simulation-of-the-multiphoton-breit-wheeler-process">Simulation of the multiphoton Breit-Wheeler process</a></li>
<li><a class="reference internal" href="#configuration-of-the-radiation-reaction-block">Configuration of the radiation reaction block</a></li>
<li><a class="reference internal" href="#configuration-of-the-multiphoton-breit-wheeler-block">Configuration of the multiphoton Breit-Wheeler block</a></li>
<li><a class="reference internal" href="#configuration-of-the-electron-species">Configuration of the electron species</a></li>
<li><a class="reference internal" href="#configuration-of-the-photon-species">Configuration of the photon species</a></li>
<li><a class="reference internal" href="#configuration-of-the-positron-species">Configuration of the positron species</a></li>
<li><a class="reference internal" href="#presentation-of-the-diagnostics">Presentation of the diagnostics</a></li>
<li><a class="reference internal" href="#simulation-analysis">Simulation analysis</a></li>
<li><a class="reference internal" href="#to-go-beyond">To go beyond</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    </div>
    
    <div class="headercolor">
    </div>
    <div class="hpositioner">
        <div class="header">
        <div class="logo">
            <a href="index.html">
                <img class="logo" src="_static/smileiLogo_tutorials.svg" alt="Logo" />
            </a>
        </div>
        
    
            
        
        <div class="menu" id="menu_Setup">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Setup')" onclick="toggleMenu('menu_Setup')" onmousedown="event.preventDefault()">
                <span>Info</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="setup.html">Setup</a>
                        </li>
            
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="menu" id="menu_Tutorial 1">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Tutorial 1')" onclick="toggleMenu('menu_Tutorial 1')" onmousedown="event.preventDefault()">
                <span>Basic</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="practical1.html">Tutorial 1</a>
                        </li>
                        <li class="outer">
                            <a href="practical2.html">Tutorial 2</a>
                        </li>
                        <li class="outer">
                            <a href="practical3.html">Tutorial 3</a>
                        </li>
                        <li class="outer">
                            <a href="practical4.html">Tutorial 4</a>
                        </li>
            
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="menu" id="menu_Advanced tutorial 1">
            <div class="menuButton" onmouseenter="thisMenuOnly('menu_Advanced tutorial 1')" onclick="toggleMenu('menu_Advanced tutorial 1')" onmousedown="event.preventDefault()">
                <span>Advanced</span>
            </div>
            <div class="off">
                <div class="toctree-smilei">
                    <ul>
                        <li class="outer">
                            <a href="advanced_practical1.html">Advanced tutorial 1</a>
                        </li>
                        <li class="outer">
                            <a href="#">Advanced tutorial 2</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical3.html">Advanced tutorial 3</a>
                        </li>
                        <li class="outer">
                            <a href="advanced_practical4.html">Advanced tutorial 4</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="searchbox" role="search" style="display:none">
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" placeholder="Search" id="searchinput" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
        
        <div id="searchicon" onclick="openSearch()" style="display:block">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g transform="translate(0,-932.36216)" >
                <circle
                   r="25" cy="977.51044" cx="38.078663"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:10;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
                <rect
                   transform="matrix(0.36717877,0.93015039,-0.93427297,0.35655858,0,0)"
                   rx="4.9996676" ry="7.4995141"
                   y="316.16959" x="947.6142"
                   height="14.117695" width="46.476151"
                   style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:none;" />
                <path
                   d="m 41.383282,962.25996 a 15,15 0 0 1 11.660107,11.6355"
                   style="opacity:1;fill:none;stroke:#ffffff;stroke-width:3;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
              </g>
            </svg>
        </div>
        <div id="closesearchicon" onclick="closeSearch()" style="display:none">
            <svg
               xmlns="http://www.w3.org/2000/svg"
               viewBox="0 0 80 120">
              <g
                 transform="translate(0,-932.36216)">
                <path
                   d="m 10,962.36216 60,60.00004"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
                <path
                   d="M 70,962.36216 10,1022.3622"
                   style="fill:none;stroke:#ffffff;stroke-width:10;stroke-linecap:round;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none" />
              </g>
            </svg>
        </div>
        
        <div id="smallScreenMenuButton" onclick="toggleSmallScreenMenu()">
            <svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"
               viewBox="-20 -20 140 140">
              <g  style="fill:#ffffff;stroke:none;">
                <circle cx="15" cy="20" r="5" />
                <circle cx="35" cy="20" r="5" />
                <circle cx="85" cy="20" r="5" />
                <rect width="50" height="10" x="35" y="15" rx="0" ry="0" />
                <circle cx="15" cy="40" r="5" />
                <circle cx="35" cy="40" r="5" />
                <circle cx="85" cy="40" r="5" />
                <rect width="50" height="10" x="35" y="35" rx="0" ry="0" />
                <circle cx="15" cy="60" r="5" />
                <circle cx="35" cy="60" r="5" />
                <circle cx="85" cy="60" r="5" />
                <rect width="50" height="10" x="35" y="55" rx="0" ry="0" />
                <circle cx="15" cy="80" r="5" />
                <circle cx="35" cy="80" r="5" />
                <circle cx="85" cy="80" r="5" />
                <rect width="50" height="10" x="35" y="75" rx="0" ry="0" />
              </g>
            </svg>
        </div>
        
    </div>
    
</div>
</div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="advanced_practical3.html" title="Advanced Practical 3: Electron Laser Wakefield Acceleration (in 2D)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="advanced_practical1.html" title="Advanced Practical 1: Synchrotron-like Radiation reaction processes"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Smilei 73aaa37 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
    <div class="documentwrapper">
      <div class="bodywrapper">
        <div class="body" role="main">
          
  <div class="section" id="advanced-practical-2-multiphoton-breit-wheeler-pair-creation-process">
<h1>Advanced Practical 2: Multiphoton Breit-Wheeler pair creation process<a class="headerlink" href="#advanced-practical-2-multiphoton-breit-wheeler-pair-creation-process" title="Permalink to this headline">¶</a></h1>
<p>The goal of this tutorial is to present how to use the multiphoton Breit-Wheeler
pair creation process in <strong class="program">Smilei</strong>.
The following points will be addressed:</p>
<ul class="simple">
<li>How to prepare input files for this physical module</li>
<li>How to setup macro-photon species and the Monte-Carlo emission</li>
<li>How to setup the multiphoton Breit-Wheeler pair creation process</li>
<li>How to use diagnostics</li>
<li>How to read and understand produced outputs</li>
</ul>
<hr class="docutils" />
<div class="section" id="physical-configuration">
<h2>Physical configuration<a class="headerlink" href="#physical-configuration" title="Permalink to this headline">¶</a></h2>
<p>A multi-GeV electron beam is made to collide with a counter-propagating plane wave.
This configuration is one of the most efficient to trigger radiative and QED effects.
It maximizes the value of the quantum parameter for a given electron energy and a
given field strength.</p>
<p>The simulation is 2D Cartesian with a simulation size of <span class="math">\(30 \lambda \times 4 \lambda\)</span>
where <span class="math">\(\lambda\)</span> is the laser wavelength. The laser is injected from the left side
of the simulation domain while the electron beam is initialized at the extreme right.</p>
<p>In this initial configuration, the laser has a wavelength of <span class="math">\(\lambda = 1\ \mu \mathrm{m}\)</span>,
an amplitude of <span class="math">\(10^{23}\ \mathrm{W/cm}^2\)</span> (<span class="math">\(a_0 \simeq 270\)</span>) and is linearly
polarized in the <cite>y</cite> direction. The temporal profile is Gaussian (order 4).
he full width at half maximum (FWHM) is of 10 laser periods (approximately 33 fs).</p>
<p>The electron beam has an initial energy of 4 GeV and propagates to the left.
The beam density is of <span class="math">\(n_b = 10^{-5} n_c\)</span>. The electron beam is frozen the
time for the laser to be fully injected and so that the collision occurred at
the middle of the domain. This enables to have a shorter simulation box and
therefore save computational time. The beam is initialized with 32 particles
per cell for a total of 3648 macro-particles.</p>
</div>
<hr class="docutils" />
<div class="section" id="content-of-the-tutorial">
<h2>Content of the tutorial<a class="headerlink" href="#content-of-the-tutorial" title="Permalink to this headline">¶</a></h2>
<p>Download <a class="reference external" href="AdvancedPractical2.tar.gz">AdvancedPractical2.tar.gz</a> and extract it.
It contains 2 directories:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Analysis</span></code></li>
<li><code class="docutils literal"><span class="pre">Execution</span></code></li>
</ul>
<p>The directory <code class="docutils literal"><span class="pre">Analysis</span></code> contains <cite>Python</cite> scripts that will be used to analysis
and visualize the simulation outputs. Each script has been designed to focus on a
specific quantity:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">show_energy_balance.py</span></code>: display the time evolution of the species kinetic energy,
the photon species energy and the radiated energy (not in the photons).</li>
<li><code class="docutils literal"><span class="pre">show_particle_number.py</span></code>: display the time evolution of the number of macro-particles
for each species.</li>
<li><code class="docutils literal"><span class="pre">show_2d_density.py</span></code>: display the 2D colormap of the electron, positron and photon density.</li>
<li><code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>: display the 2D colormap of the electron, positron and
photon average normalized energy.</li>
<li><code class="docutils literal"><span class="pre">show_2d_average_chi.py</span></code>: display the 2D colormap of the electron, positron and
photon quantum parameter.</li>
<li><code class="docutils literal"><span class="pre">show_2d_fields.py</span></code>: display 2D colormaps  of the electric field <span class="math">\(E_y\)</span>
and the magnetic field <span class="math">\(B_z\)</span>.</li>
<li><code class="docutils literal"><span class="pre">show_energy_spectrum.py</span></code>: display the electron, positron and photon energy
distribution at a given time.</li>
</ul>
<p>The <code class="docutils literal"><span class="pre">Execution</span></code> directory contains the input file:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">tst2d_electron_laser_collision.py</span></code></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="simulation-of-the-multiphoton-breit-wheeler-process">
<h2>Simulation of the multiphoton Breit-Wheeler process<a class="headerlink" href="#simulation-of-the-multiphoton-breit-wheeler-process" title="Permalink to this headline">¶</a></h2>
<p>We will first lean how to configure the input file for the Monte-Carlo process
with macro-photon emission followed by the Multiphoton Breit-Wheeler
pair creation process.
For this simulation case, we will need to define three species: electrons, positrons and photons.
After the configuration, we will then run our simulation test case.
Finally, we will see how to read and exploit diagnostic outputs via Python script
and the <strong class="program">happi</strong> post-processing module.</p>
<ul>
<li><p class="first">Make a copy of the directory <code class="docutils literal"><span class="pre">Execution</span></code> and name it
<code class="docutils literal"><span class="pre">Multiphoton_Breit_Wheeler</span></code>. We will perform the simulation in this directory.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp -r Execution Multiphoton_Breit_Wheeler
<span class="nb">cd</span> Multiphoton_Breit_Wheeler
</pre></div>
</div>
</li>
<li><p class="first">Open the input file <code class="docutils literal"><span class="pre">tst2d_electron_laser_collision.py</span></code>.</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="configuration-of-the-radiation-reaction-block">
<h2>Configuration of the radiation reaction block<a class="headerlink" href="#configuration-of-the-radiation-reaction-block" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Go to the <code class="docutils literal"><span class="pre">RadiationReaction</span></code> block.</p>
</li>
<li><p class="first">The Monte-Carlo algorithm uses tabulated values.
The path needs to be specified in the block <code class="docutils literal"><span class="pre">RadiationReaction</span></code> via the parameter <code class="docutils literal"><span class="pre">table_path</span></code>.
The tables are located in the directory <code class="docutils literal"><span class="pre">databases</span></code> at the root of the <strong class="program">Smilei</strong> repository.
Uncomment this parameter and update the path to the location of your <strong class="program">Smilei</strong> installation.</p>
</li>
<li><p class="first">The parameter <code class="docutils literal"><span class="pre">chipa_radiation_threshold</span></code> corresponds to the minimal value
of the quantum parameter at which the radiation reaction process is applied.
Below this value, the particle does not undergo radiation reaction.
Uncomment the corresponding line.
Specifying this parameter is actually not compulsory since it is defined
by default at <span class="math">\(10^{-3}\)</span>.</p>
</li>
<li><p class="first">Uncomment the line with the parameter <code class="docutils literal"><span class="pre">chipa_disc_min_threshold</span></code>.
The Monte-Carlo model is built to work with
the continuous corrected Landau-Lifshitz approach when the particle quantum parameter is too low.
This parameter corresponds to this threshold.
Above this value, a particle undergoes radiation reaction via the Monte-Carlo engine.
Below the continuous approach is used.
This parameter is by default equal to <span class="math">\(10^{-2}\)</span>
but it is modified to be <span class="math">\(10^{-3}\)</span> here.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">RadiationReaction</span></code> should now look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">RadiationReaction</span><span class="p">(</span>
     <span class="n">chipa_radiation_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span>
     <span class="n">chipa_disc_min_threshold</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">,</span>
     <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;path_to_smilei&gt;/databases/&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="configuration-of-the-multiphoton-breit-wheeler-block">
<h2>Configuration of the multiphoton Breit-Wheeler block<a class="headerlink" href="#configuration-of-the-multiphoton-breit-wheeler-block" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Go to the <code class="docutils literal"><span class="pre">MultiphotonBreitWheeler</span></code> block.
This block controls the general parameters of the Multiphoton Breit-Wheeler process.</p>
</li>
<li><p class="first">The Monte-Carlo algorithm for the Multiphoton Breit-Wheeler process uses tabulated values.
The path needs to be specified in the block <code class="docutils literal"><span class="pre">MultiphotonBreitWheeler</span></code> via the parameter <code class="docutils literal"><span class="pre">table_path</span></code>.
The tables are located in the directory <code class="docutils literal"><span class="pre">databases</span></code> at the root of the <strong class="program">Smilei</strong> repository.
Uncomment this parameter and update the path to the location of your <strong class="program">Smilei</strong> installation.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">MultiphotonBreitWheeler</span></code> should now look like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">MultiphotonBreitWheeler</span><span class="p">(</span>
     <span class="n">table_path</span> <span class="o">=</span> <span class="s2">&quot;&lt;path_to_smilei&gt;/databases/&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="configuration-of-the-electron-species">
<h2>Configuration of the electron species<a class="headerlink" href="#configuration-of-the-electron-species" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">We will first configure the <code class="docutils literal"><span class="pre">electron</span></code> species that composes the beam so that
it can radiate via the Monte-Carlo model and generate macro-photons
Go to the <code class="docutils literal"><span class="pre">electron</span></code> species block. you can see that the radiation parameters
are commented.</p>
</li>
<li><p class="first">The parameter <code class="docutils literal"><span class="pre">radiation_model</span></code> corresponds to the type of radiation model to be used.
Uncomment the corresponding line. We use here the <code class="docutils literal"><span class="pre">Monte-Carlo</span></code>.</p>
</li>
<li><p class="first">When <code class="docutils literal"><span class="pre">radiation_photon_species</span></code> is present and not set to <code class="docutils literal"><span class="pre">None</span></code>,
the possibility to generate macro-photons is activated. This parameter has to be set to
the name of the <code class="docutils literal"><span class="pre">photon</span></code> species that will receive the created macro-photons.
Uncomment the corresponding line. The photon species is called <code class="docutils literal"><span class="pre">photon</span></code>.</p>
</li>
<li><p class="first">The parameter <code class="docutils literal"><span class="pre">radiation_photon_sampling</span></code> enables to control the number of
macro-photons generated per emission even. By default, an emission yields a
single macro-photons of weight similar to the emitting particle. to increase
the emission statistics, you can decide to increase this number so that several
macro-photons are generated per even. In this case, the weight is equally
divided between macro-photons for quantity conservation.
Uncomment the corresponding line.</p>
</li>
<li><p class="first">The parameter <code class="docutils literal"><span class="pre">radiation_photon_gamma_threshold</span></code> enables to control the
minimum threshold on the photon energy that allow macro-photon emission.
Below the specified value, the radiation reaction is taken into account
but no macro-photon is created.
Here, since photons of energy below twice the electron rest mass energy have
no chance to turn into electron-positron pairs, this threshold is set to 2.
This value is actually the default one.
Uncomment the corresponding line.</p>
</li>
<li><p class="first">The radiation parameters of the <code class="docutils literal"><span class="pre">electron</span></code> species block are now:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;electron&quot;</span><span class="p">,</span>
<span class="o">...</span>
    <span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;Monte-Carlo&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_species</span> <span class="o">=</span> <span class="s2">&quot;photon&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_sampling</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">radiation_photon_gamma_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">The electron species is now configured.</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="configuration-of-the-photon-species">
<h2>Configuration of the photon species<a class="headerlink" href="#configuration-of-the-photon-species" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">We will then configure the <code class="docutils literal"><span class="pre">photon</span></code> species that will receive the macro-photons
generated by the other species via the Monte-Carlo radiation model.
Go to the <code class="docutils literal"><span class="pre">photon</span></code> species block. you can see that the Multiphoton
Breit-Wheeler parameters are commented. They start by <code class="docutils literal"><span class="pre">multiphoton_Breit_Wheeler</span></code>.</p>
</li>
<li><p class="first">The parameter <code class="docutils literal"><span class="pre">multiphoton_Breit_Wheeler</span></code> is a list of two strings.
These strings respectively correspond
to the species name that will receive the created electron and the created positron.
Uncomment the corresponding line.
The electron and the positron species respectively correspond to <code class="docutils literal"><span class="pre">electron</span></code> and <code class="docutils literal"><span class="pre">positron</span></code>.
When this parameter is commented, the multiphoton Breit-Wheeler is not activated.</p>
</li>
<li><p class="first">The parameter <code class="docutils literal"><span class="pre">multiphoton_Breit_Wheeler_sampling</span></code> is the number of
macro-electron and macro-positron generated per Monte-Carlo event.
This parameter is a list of two integers.
By default, an electron and a positron are generated per event.
To improve the statistics, these numbers can be increased.
The macro-particle weight is then divided in consequence.
Uncomment the corresponding line.</p>
</li>
<li><p class="first">The multiphoton Breit-Wheeler parameters for the <code class="docutils literal"><span class="pre">photon</span></code> species block are now:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;photon&quot;</span><span class="p">,</span>
<span class="o">...</span>
    <span class="n">multiphoton_Breit_Wheeler</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;electron&quot;</span><span class="p">,</span><span class="s2">&quot;positron&quot;</span><span class="p">],</span>
    <span class="n">multiphoton_Breit_Wheeler_sampling</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="configuration-of-the-positron-species">
<h2>Configuration of the positron species<a class="headerlink" href="#configuration-of-the-positron-species" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">We will then configure the <code class="docutils literal"><span class="pre">positron</span></code> species that will receive the macro-positrons
generated via the multiphoton Breit-Wheeler.
Go to the <code class="docutils literal"><span class="pre">positron</span></code> species block.</p>
</li>
<li><p class="first">As for the <code class="docutils literal"><span class="pre">electron</span></code> species, uncomment the radiation parameters as follow:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">Species</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;positron&quot;</span><span class="p">,</span>
<span class="o">...</span>
    <span class="n">radiation_model</span> <span class="o">=</span> <span class="s2">&quot;Monte-Carlo&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_species</span> <span class="o">=</span> <span class="s2">&quot;photon&quot;</span><span class="p">,</span>
    <span class="n">radiation_photon_sampling</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">radiation_photon_gamma_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
<span class="o">...</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p>The positrons will also radiate with the Monte-Carlo model.</p>
</div>
<hr class="docutils" />
<div class="section" id="presentation-of-the-diagnostics">
<h2>Presentation of the diagnostics<a class="headerlink" href="#presentation-of-the-diagnostics" title="Permalink to this headline">¶</a></h2>
<p>Several diagnostics are defined in the input file.</p>
<ul>
<li><p class="first">Time-evolution of scalar quantities are configured via the <code class="docutils literal"><span class="pre">DiagScalar</span></code> block.
Here, output of the radiated energy (not including the macro-photons)
is requested via <code class="docutils literal"><span class="pre">Urad</span></code>. <code class="docutils literal"><span class="pre">Ukin_&lt;species&gt;</span></code> corresponds to the kinetic energy of <code class="docutils literal"><span class="pre">&lt;species&gt;</span></code>
(total energy for the photons). <code class="docutils literal"><span class="pre">Ntot_&lt;species&gt;</span></code> is the number of macro-particles.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">DiagScalar</span><span class="p">(</span>
    <span class="n">every</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Uelm&#39;</span><span class="p">,</span><span class="s1">&#39;Ukin&#39;</span><span class="p">,</span><span class="s1">&#39;Utot&#39;</span><span class="p">,</span><span class="s1">&#39;Uexp&#39;</span><span class="p">,</span><span class="s1">&#39;Ubal&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Urad&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ukin_electron&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ukin_positron&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ukin_photon&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ntot_electron&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ntot_positron&#39;</span><span class="p">,</span>
          <span class="s1">&#39;Ntot_photon&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">The field grids are damped every 500 iterations via the block <code class="docutils literal"><span class="pre">DiagFields</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">DiagParticleBinning</span></code> blocks enable to project the particle
quantities on specified multidimensional grids.
There are 4 types of diagnostics configured in the input file for each species:</p>
<ul class="simple">
<li><ol class="first arabic">
<li>the species <cite>weight</cite> distribution</li>
</ol>
</li>
<li><ol class="first arabic" start="2">
<li>the kinetic energy times the weight (<code class="docutils literal"><span class="pre">weight_ekin</span></code>)</li>
</ol>
</li>
<li><ol class="first arabic" start="3">
<li>the quantum parameter time the weight (<code class="docutils literal"><span class="pre">weight_chi</span></code>)</li>
</ol>
</li>
<li><ol class="first arabic" start="4">
<li>the species energy distribution</li>
</ol>
</li>
</ul>
<p>The particle binning diagnostics are damped every 500 iterations.</p>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="simulation-analysis">
<h2>Simulation analysis<a class="headerlink" href="#simulation-analysis" title="Permalink to this headline">¶</a></h2>
<p>After you have run the simulation, you may start analyzing its results.</p>
<ul>
<li><p class="first">Let us first analyze the time-evolution of the number of macro-particles
in the simulation.
Copy the file <code class="docutils literal"><span class="pre">Analysis/show_particle_number.py</span></code> in the working directory:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_particle_number.py .
</pre></div>
</div>
<p>Run the script using iPython:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ipython
run show_particle_number.py
</pre></div>
</div>
</li>
<li><p class="first">You should obtain the following graph:</p>
<img alt="_images/particle_number.png" src="_images/particle_number.png" />
<p>When the laser starts to interact with the electron beam around <span class="math">\(t = 230 \omega_r^{-1}\)</span>,
the number of macro-photons rises rapidly due thanks to
the Monte-Carlo radiation model.
Later, these photons start to decay into electron-positron pairs
via the multiphoton Breit-Wheeler.
We can observe an increase of the number of macro-electrons and macro-positrons
from <span class="math">\(t = 235 \omega_r^{-1}\)</span></p>
</li>
<li><p class="first">Copy the file <code class="docutils literal"><span class="pre">Analysis/show_energy_balance.py</span></code> in the working directory
and run the script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_energy_balance.py .
ipython
run show_energy_balance.py
</pre></div>
</div>
</li>
<li><p class="first">You should obtain the following graph:</p>
<img alt="_images/energy_balance.png" src="_images/energy_balance.png" />
</li>
<li><p class="first">We will now use the particle binning diagnostics.
Copy the file <code class="docutils literal"><span class="pre">Analysis/show_2d_average_energy.py</span></code> in the working directory
and run the script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_2d_average_energy.py .
ipython
run show_2d_average_energy.py
</pre></div>
</div>
<p>You should obtain the following graph:</p>
<img alt="_images/2d_average_energy_it5500.png" src="_images/2d_average_energy_it5500.png" />
<p>From the top to the bottom, you have respectively the electron, positron
normalized kinetic energy and the photon normalized energy.</p>
</li>
<li><p class="first">Open the script <code class="docutils literal"><span class="pre">show_2d_average_energy.py</span></code>. In the section <cite>Parameters</cite>,
you can play with the parameter <code class="docutils literal"><span class="pre">timestep</span></code> that plot the species average energy
at different iteration. Rerun the script at different timesteps.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># ______________________________________________________________________________</span>
<span class="c1"># Parameters</span>

<span class="c1"># Path to the simulation directory</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>

<span class="c1"># Time step for the diagnotics</span>
<span class="n">timestep</span> <span class="o">=</span> <span class="mi">5500</span>
</pre></div>
</div>
<p>Observe the evolution of the different species energy all along the simulation.</p>
</li>
<li><p class="first">We will now do the same thing for the weight (normalized local density).
Copy the file <code class="docutils literal"><span class="pre">Analysis/show_2d_density.py</span></code> in the working directory
and run the script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_2d_density.py .
ipython
run show_2d_density.py
</pre></div>
</div>
<p>You should obtain the following figure:</p>
<img alt="_images/2d_density_it5500.png" src="_images/2d_density_it5500.png" />
<p>Change the <code class="docutils literal"><span class="pre">timestep</span></code> parameter to see how the beam shape evolves during
the simulation and how the positron are created.</p>
</li>
<li><p class="first">We can also look at the quantum parameter.
Copy the file <code class="docutils literal"><span class="pre">Analysis/show_2d_average_chi.py</span></code> in the working directory
and run the script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_2d_average_chi.py .
ipython
run show_2d_average_chi.py
</pre></div>
</div>
<p>You should obtain the following figure:</p>
<img alt="_images/2d_average_chi_it5500.png" src="_images/2d_average_chi_it5500.png" />
<p>The maximal value of the quantum parameter is printed in the terminal.
Change the <code class="docutils literal"><span class="pre">timestep</span></code> parameter to see how the electron, positron and photon
average quantum parameter evolve during
the simulation.</p>
</li>
<li><p class="first">To get an idea of where in the laser field the beam is located,
you can use the script <code class="docutils literal"><span class="pre">Analysis/show_2d_fields.py</span></code>
Copy and run it:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_2d_fields.py .
ipython
run show_2d_fields.py
</pre></div>
</div>
<p>You should obtain the following figure:</p>
<img alt="_images/2d_fields_it5500.png" src="_images/2d_fields_it5500.png" />
<p>Change the <code class="docutils literal"><span class="pre">timestep</span></code> parameter as for the particle binning diagnostics.</p>
</li>
<li><p class="first">Finally, we want to analysis the final energy spectra of the species.
For this aim, copy the script <code class="docutils literal"><span class="pre">Analysis/show_energy_spectrum.py</span></code> and run it.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cp ../Analysis/show_energy_spectrum.py .
ipython
run show_energy_spectrum
</pre></div>
</div>
<p>You should obtain the following figure:</p>
<img alt="_images/energy_spectrum_it8000.png" src="_images/energy_spectrum_it8000.png" />
</li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="to-go-beyond">
<h2>To go beyond<a class="headerlink" href="#to-go-beyond" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Optional exercice:</strong> Change the laser and electron beam properties to see
how it affects the beam energy loss and the production of electron-positron pairs.</li>
<li><strong>Optional exercice:</strong> Use the same input file to build a similar case in 3D.
You will have to increase the number of nodes.
Use a focused laser pulse instead a place wave and see how the pulse waist
affect the interaction (final positron energy, beam divergence…).</li>
<li><strong>Optional exercice:</strong> Activate the load balancing and change the number of
patches to see how it affects the performances.</li>
</ul>
</div>
</div>


        </div></div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="advanced_practical3.html" title="Advanced Practical 3: Electron Laser Wakefield Acceleration (in 2D)"
             >next</a> |</li>
        <li class="right" >
          <a href="advanced_practical1.html" title="Advanced Practical 1: Synchrotron-like Radiation reaction processes"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Smilei 73aaa37 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer">
      <div>
      <a href="site.html">Site index</a>
      </div>
      <div>
        Last updated on Jan 11, 2018
      </div>
      
      <div>
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      </div>
      
    </div>
    
    <script type="text/javascript">
        
        var nav_list = document.getElementById("nav_list");
        var nav_button = document.getElementById("nav_button");
        var smallScreenMenu = document.getElementById("smallScreenMenu");
        var smallScreenMenuButton = document.getElementById("smallScreenMenuButton");
        var searchicon = document.getElementById("searchicon");
        var searchbox  = document.getElementById("searchbox");
        var searchinput= document.getElementById("searchinput");
        var menus = document.getElementsByClassName("menu");
        for( var i=0; i<menus.length; i++ )
            menus[i].active = false;
        
        
        var ul = nav_list.getElementsByTagName("ul")[0], li;
        var keep_nav = false;
        if( ul ) {
            li = ul.firstElementChild;
            if( li ) {
                if( li.getElementsByTagName("ul").length > 0 ) keep_nav = true;
            }
        }
        if( keep_nav ) {
            li.removeChild( li.firstElementChild );
        } else {
            document.getElementById("nav_positioner").removeChild( document.getElementById("nav") );
        }
        
        function navOff() {
            nav_list.style.display = "none";
            nav_button.className = "";
        }
        
        function toggleNav() {
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
            if( nav_list.style.display != "inline-block" ) {
                nav_list.style.display = "inline-block";
                nav_button.className = "pushed";
            } else {
                navOff();
            }
        }
        
        function toggleSmallScreenMenu() {
            if( smallScreenMenu.className != "on" ) {
                smallScreenMenu.className = "on";
                smallScreenMenuButton.className = "pushed";
            } else {
                smallScreenMenu.className = "off";
                smallScreenMenuButton.className = "";
            }
        }
        
        function menuOn( menu ) {
            var divs = menu.getElementsByTagName("div");
            if(nav_list) navOff();
            divs[1].className = "on";
            divs[0].className = "menuButton pushed";
            menu.active = true;
        }
        function menuOff( menu ) {
            var divs = menu.getElementsByTagName("div");
            divs[1].className = "off";
            divs[0].className = "menuButton";
            menu.active = false;
        }
        
        function thisMenuOnly(menu_id) {
            var menu = document.getElementById(menu_id);
            for( var i=0; i<menus.length; i++ )
                if( i!=menu_id )
                    menuOff( menus[i] );
            menuOn( menu );
        }
        
        function toggleMenu(menu_id) {
            var menu = document.getElementById(menu_id);
            if( menu.active ) {
                menuOff( menu );
            } else {
                for( var i=0; i<menus.length; i++ )
                    if( i!=menu_id )
                        menuOff( menus[i] );
                menuOn( menu );
            }
        }
        
        function openSearch() {
            for( var i=0; i<menus.length; i++ ) {
                menuOff( menus[i] );
                menus[i].style.zIndex = "-1";
            }
            searchicon.style.display = "none";
            closesearchicon.style.display = "block";
            searchbox.style.display = "block";
            searchinput.focus();
        }
        
        function closeSearch() {
            searchicon.style.display = "block";
            closesearchicon.style.display = "none";
            searchbox .style.display = "none";
            for( var i=0; i<menus.length; i++ )
                menus[i].style.zIndex = "0";
        }
        
        
        var documentDiv = document.getElementsByClassName("document")[0];
        documentDiv.addEventListener('click', function (event) {
            if(nav_list) navOff();
            for( var i=0; i<menus.length; i++ )
                menuOff( menus[i] );
        });
    </script>
  </body>
</html>